<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>环境搭建 | giscat doc</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="giscat 开发文档">
    
    <link rel="preload" href="/assets/css/0.styles.e8e4f3a3.css" as="style"><link rel="preload" href="/assets/js/app.be904724.js" as="script"><link rel="preload" href="/assets/js/2.733019b2.js" as="script"><link rel="preload" href="/assets/js/16.51390020.js" as="script"><link rel="prefetch" href="/assets/js/10.392bb761.js"><link rel="prefetch" href="/assets/js/11.78dd257a.js"><link rel="prefetch" href="/assets/js/12.7e5b06b2.js"><link rel="prefetch" href="/assets/js/13.93dc9726.js"><link rel="prefetch" href="/assets/js/14.f419db21.js"><link rel="prefetch" href="/assets/js/15.cbd723aa.js"><link rel="prefetch" href="/assets/js/17.2fa5ad06.js"><link rel="prefetch" href="/assets/js/18.a4ef24f9.js"><link rel="prefetch" href="/assets/js/3.7590745a.js"><link rel="prefetch" href="/assets/js/4.d12742be.js"><link rel="prefetch" href="/assets/js/5.216cae74.js"><link rel="prefetch" href="/assets/js/6.2d0a63f8.js"><link rel="prefetch" href="/assets/js/7.dadd7614.js"><link rel="prefetch" href="/assets/js/8.ab3ffe85.js"><link rel="prefetch" href="/assets/js/9.9263adf4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e8e4f3a3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/logo.jpg" alt="giscat doc" class="logo"> <span class="site-name can-hide">giscat doc</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文档" class="dropdown-title"><span class="title">文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="文档" class="mobile-dropdown-title"><span class="title">文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/giscat-server/quickstart/" class="nav-link router-link-active">
  giscat-server
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="github" class="dropdown-title"><span class="title">github</span> <span class="arrow down"></span></button> <button type="button" aria-label="github" class="mobile-dropdown-title"><span class="title">github</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/codingmiao/giscat" target="_blank" rel="noopener noreferrer" class="nav-link external">
  giscat-server
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/codingmiao/giscat-server" target="_blank" rel="noopener noreferrer" class="nav-link external">
  giscat-tools
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文档" class="dropdown-title"><span class="title">文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="文档" class="mobile-dropdown-title"><span class="title">文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/giscat-server/quickstart/" class="nav-link router-link-active">
  giscat-server
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="github" class="dropdown-title"><span class="title">github</span> <span class="arrow down"></span></button> <button type="button" aria-label="github" class="mobile-dropdown-title"><span class="title">github</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/codingmiao/giscat" target="_blank" rel="noopener noreferrer" class="nav-link external">
  giscat-server
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/codingmiao/giscat-server" target="_blank" rel="noopener noreferrer" class="nav-link external">
  giscat-tools
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">Home</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/giscat-server/quickstart/" class="sidebar-heading clickable router-link-active open"><span>giscat server</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/giscat-server/quickstart/" class="sidebar-heading clickable router-link-active open"><span>快速开始</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/giscat-server/quickstart/" aria-current="page" class="sidebar-link">接口示例</a></li><li><a href="/giscat-server/quickstart/env.html" aria-current="page" class="active sidebar-link">环境搭建</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/giscat-server/quickstart/env.html#安装postgis" class="sidebar-link">安装postgis</a></li><li class="sidebar-sub-header"><a href="/giscat-server/quickstart/env.html#导入示例配置和测试数据到postgis中" class="sidebar-link">导入示例配置和测试数据到postgis中</a></li><li class="sidebar-sub-header"><a href="/giscat-server/quickstart/env.html#安装jdk11" class="sidebar-link">安装jdk11</a></li><li class="sidebar-sub-header"><a href="/giscat-server/quickstart/env.html#安装并启动giscat-server" class="sidebar-link">安装并启动giscat-server</a></li></ul></li><li><a href="/giscat-server/quickstart/config-scan.html" class="sidebar-link">示例数据与配置简介</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/giscat-server/api/" class="sidebar-heading clickable"><span>接口说明</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/giscat-server/plugin/" class="sidebar-heading clickable"><span>插件扩展</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="环境搭建"><a href="#环境搭建" class="header-anchor">#</a> 环境搭建</h1> <p>默认地，giscat-server需要postgis数据库和11及以上版本的jdk。
（其实，postgis数据库并不是必须的，您只需要一个关系型数据库来存储giscat-server的配置信息，oracle、mysql甚至sqlite都可以，然后再有一个数据集插件来获取您的gis数据即可，但是建议您对giscat-server有一定的了解后再考虑做这些事。）</p> <h2 id="安装postgis"><a href="#安装postgis" class="header-anchor">#</a> 安装postgis</h2> <p>限于篇幅，本节使用docker安装，您也可以不用docker直接安装</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /mydata/postgres/database_data

<span class="token function">docker</span> run <span class="token parameter variable">--name</span> postgis <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /mydata/postgres/database_data:/var/lib/postgresql/data <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">POSTGRES_PASSWORD</span><span class="token operator">=</span>sde <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> <span class="token parameter variable">--publish</span> <span class="token string">&quot;0.0.0.0:5432:5432&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--privileged</span> postgis/postgis:13-3.3 

</code></pre></div><p>这里，生成了一个用户名是postgres、密码是sde、端口是5432的postgis容器，并把容器内的pg数据存储目录映射到了宿主机的/mydata/postgres/database_data。</p> <h2 id="导入示例配置和测试数据到postgis中"><a href="#导入示例配置和测试数据到postgis中" class="header-anchor">#</a> 导入示例配置和测试数据到postgis中</h2> <p><a href="/assets/data/giscat_demo.zip">点击这里</a>下载文件并解压，得到示例配置giscat_config.dump、测试数据giscat_testdata.dump。</p> <p>拷贝dump到容器映射出来的路径，这样在容器内就能看到这两个dump</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">cp</span> giscat_config.dump /mydata/postgres/database_data/
<span class="token function">cp</span> giscat_testdata.dump /mydata/postgres/database_data/
</code></pre></div><p>进入容器并切换至postgres用户</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 进入容器</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> postgis <span class="token function">bash</span>
<span class="token comment"># 切换postgres用户</span>
<span class="token function">su</span> postgres
<span class="token builtin class-name">cd</span> /var/lib/postgresql/data
</code></pre></div><p>进入psql命令行，新建数据库giscat_config、giscat_testdata</p> <div class="language-shell extra-class"><pre class="language-shell"><code>psql
create database giscat_config<span class="token punctuation">;</span>
create database giscat_testdata<span class="token punctuation">;</span>
<span class="token builtin class-name">exit</span>
</code></pre></div><p>建库命令运行结果如下：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>postgres@b59bbdec8e03:~/data$ psql
psql <span class="token punctuation">(</span><span class="token number">13.10</span> <span class="token punctuation">(</span>Debian <span class="token number">13.10</span>-1.pgdg110+1<span class="token punctuation">))</span>
Type <span class="token string">&quot;help&quot;</span> <span class="token keyword">for</span> help.

<span class="token assign-left variable">postgres</span><span class="token operator">=</span><span class="token comment"># create database giscat_config;</span>
CREATE DATABASE
<span class="token assign-left variable">postgres</span><span class="token operator">=</span><span class="token comment"># create database giscat_testdata;</span>
CREATE DATABASE
<span class="token assign-left variable">postgres</span><span class="token operator">=</span><span class="token comment"># exit</span>
postgres@b59bbdec8e03:~/data$

</code></pre></div><p>导入dump</p> <div class="language-shell extra-class"><pre class="language-shell"><code>psql <span class="token parameter variable">-h</span> <span class="token number">127.0</span>.0.1  <span class="token parameter variable">-p</span> <span class="token number">5432</span> <span class="token parameter variable">-U</span> postgres giscat_config <span class="token operator">&lt;</span>./giscat_config.dump
psql <span class="token parameter variable">-h</span> <span class="token number">127.0</span>.0.1  <span class="token parameter variable">-p</span> <span class="token number">5432</span> <span class="token parameter variable">-U</span> postgres giscat_testdata <span class="token operator">&lt;</span>./giscat_testdata.dump
</code></pre></div><p>至此，数据准备完毕，一路exit退出到宿主机即可。</p> <p>注意，如果您为postgis设置的用户名、密码等不是默认的，请参考下列语句修改data_connect表</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 进入psql</span>
psql

<span class="token comment"># 切到giscat_config库</span>
<span class="token punctuation">\</span>c giscat_config

<span class="token comment"># 执行update语句</span>
UPDATE public.data_connect
SET config <span class="token operator">=</span> <span class="token string">'{
  &quot;username&quot;: &quot;postgres&quot;,
  &quot;password&quot;: &quot;xxx&quot;,
  &quot;jdbcUrl&quot;: &quot;jdbc:postgresql://localhost:5432/giscat_testdata&quot;,
  &quot;driverClassName&quot;: &quot;org.postgresql.Driver&quot;,
  &quot;minimumIdle&quot;: 1,
  &quot;maximumPoolSize&quot;: 20
}
'</span>
WHERE <span class="token function">id</span> LIKE <span class="token string">'giscat_testdata'</span> ESCAPE <span class="token string">'#'</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="安装jdk11"><a href="#安装jdk11" class="header-anchor">#</a> 安装jdk11</h2> <p>giscat-server需要11及以上版本的jdk才能运行，由于版权的原因，建议使用openjdk。</p> <p>下载并解压缩openjdk11到指定目录</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">wget</span> https://download.java.net/java/GA/jdk11/9/GPL/openjdk-11.0.2_linux-x64_bin.tar.gz
<span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> openjdk-11.0.2_linux-x64_bin.tar.gz
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /mydata/java
<span class="token function">mv</span> jdk-11.0.2 /mydata/java/
</code></pre></div><p>配置环境变量，这步是可选的，如果您由于安装了其它版本jdk等原因而不想配环境变量，只需在启动时指定jdk11 java的绝对路径即可，例如<code>/mydata/java/jdk-11.0.2/bin/java -jar xxx</code></p> <p><code>vi ~/.bashrc</code>,添加以下变量，注意不要写在第一行</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/mydata/java/jdk-11.0.2/

<span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_BIN</span><span class="token operator">=</span><span class="token variable">$JAVA_HOME</span>/bin
<span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_LIB</span><span class="token operator">=</span><span class="token variable">$JAVA_HOME</span>/lib
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CLASSPATH</span><span class="token operator">=</span>.:<span class="token variable">$JAVA_LIB</span>/tools.jar:<span class="token variable">$JAVA_LIB</span>/dt.jar
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token variable">$JAVA_BIN</span><span class="token builtin class-name">:</span><span class="token environment constant">$PATH</span>
</code></pre></div><p>:wq <code>source ~/.bashrc</code>使得环境变量生效即可</p> <h2 id="安装并启动giscat-server"><a href="#安装并启动giscat-server" class="header-anchor">#</a> 安装并启动giscat-server</h2> <p>前往 https://github.com/codingmiao/giscat-server/releases/ 下载最新版的giscat-server.zip并解压到指定目录</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment">#下载zip文件，注意选择版本号</span>
https://github.com/codingmiao/giscat-server/releases/download/1.0.0/giscat-server.zip
<span class="token function">unzip</span> giscat-server.zip
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /mydata/japps
<span class="token function">mv</span> giscat-server /mydata/japps/
<span class="token builtin class-name">cd</span> /mydata/japps/giscat-server/
</code></pre></div><p>启动</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">java</span> <span class="token parameter variable">-jar</span> giscat-server-main-1.0.0-STABLE.jar
</code></pre></div><p>或直接后台运行,日志文件在logs目录下</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">nohup</span> <span class="token function">java</span> <span class="token parameter variable">-jar</span> giscat-server-main-1.0.0-STABLE.jar <span class="token operator">&gt;</span>/dev/null <span class="token operator">&amp;</span>
</code></pre></div><p>随便挑个接口curl测试一下是否能查出数据：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">curl</span> <span class="token string">'http://localhost:12331/giscat-server/DataSet/giscat_testdata_test_polygon/Nearest?properties=id,name&amp;x=101.5&amp;y=20.4&amp;n=3'</span>
</code></pre></div><p>至此，本地环境已经跑起来了，下一节我们介绍如何导入数据、修改配置，这样我们就能在giscat-server中使用自己的业务数据生成的图层了。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/19/2023, 12:25:22 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/giscat-server/quickstart/" class="prev router-link-active">
        接口示例
      </a></span> <span class="next"><a href="/giscat-server/quickstart/config-scan.html">
        示例数据与配置简介
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.be904724.js" defer></script><script src="/assets/js/2.733019b2.js" defer></script><script src="/assets/js/16.51390020.js" defer></script>
  </body>
</html>
